<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>My first three.js app</title>
    <style>
      body {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="canvas"></div>
    <script type="module">
      import * as THREE from "./three/src/Three.js";
      import { OrbitControls } from "./three/examples/jsm/controls/OrbitControls.js";
      import {GLTFLoader} from "./three/examples/jsm/loaders/GLTFLoader.js";      
      import {DRACOLoader} from "./three/examples/jsm/loaders/DRACOLoader.js";
      const scene = new THREE.Scene();
      const container = document.getElementById('canvas')

      function createCamera(){
        return new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      }
      const camera = createCamera()

      function createRenderer(){
        let renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);
        return renderer
      }
      const renderer = createRenderer()
      
      
      const controls = new OrbitControls(camera, container);

      function cube(pos, dim, color, cast, receive){
        let geometry = new THREE.BoxGeometry(dim[0], dim[1], dim[2]);
        let material = new THREE.MeshBasicMaterial({ color: color});
        let c = new THREE.Mesh(geometry, material);
        c.position.set(pos.x, pos.y, pos.z)
        scene.add(c);
        return c
      }
      let cube1 = cube(
        {x: 0, y: 2, z: 0},
        [1,1,1],
        0x00aaff,
        true,
        true
      )
      
      function plane(pos, dim, color, cast, receive){
        let geo = new THREE.PlaneGeometry(dim[0], dim[1])
        let mat = new THREE.MeshBasicMaterial({color:color})
        let p = new THREE.Mesh(geo, mat)
        p.position.set(pos.x, pos.y, pos.z)
        p.rotation.x = -90/(180/Math.PI)
        scene.add(p)
        return p
      }
      let plane1 = plane(
        {x:0, y:0, z: 0},
        [5,5],
        0x656565,
        false,
        false
      )
     
      camera.position.z = 5;
      camera.position.y = 5;
      
/////////////////////////////////

// Instantiate a loader
const loader = new GLTFLoader();

// Optional: Provide a DRACOLoader instance to decode compressed mesh data
const dracoLoader = new DRACOLoader();
dracoLoader.setDecoderPath( './three/examples/js/libs/draco/' );
loader.setDRACOLoader( dracoLoader );

// Load a glTF resource
loader.load(
	// resource URL
	'./assets/terrain2.glb',
	// called when the resource is loaded
	function ( gltf ) {

		scene.add( gltf.scene );

		gltf.animations; // Array<THREE.AnimationClip>
		gltf.scene; // THREE.Group
		gltf.scenes; // Array<THREE.Group>
		gltf.cameras; // Array<THREE.Camera>
		gltf.asset; // Object

	},
	// called while loading is progressing
	function ( xhr ) {

		console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

	},
	// called when loading has errors
	function ( error ) {

		console.log( 'An error happened' );

	}
);

////////////////////////////////
      function animate() {
        controls.update()

        requestAnimationFrame(animate);

        cube1.rotation.x += 0.01;
        cube1.rotation.y += 0.01;

        renderer.render(scene, camera);
      }

      animate();
    </script>
  </body>
</html>
